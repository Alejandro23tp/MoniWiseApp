<app-header></app-header>

<ion-content>
  <ng-container
    *ngIf="!existeSueldoFijo || mostrarFormulario; else sueldoFijoExistente"
  >
    <ion-list>
      <ion-item>
        <ion-label color="tertiary">Frecuencia</ion-label>
        <ion-select
          [(ngModel)]="sueldoFijo_frecuencia_id"
          placeholder="Seleccionar Frecuencia"
          interface="popover"
          (ionChange)="actualizarFechaFinal()"
        >
          <ion-select-option
            *ngFor="let frecuencia of listaFrecuencias"
            [value]="frecuencia.id"
          >
            {{ frecuencia.frecuencia }}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item lines="inset">
        <ion-label position="floating">Monto</ion-label>
        <ion-input [(ngModel)]="sueldoFijo_monto" type="number"></ion-input>
      </ion-item>

      <ion-grid fixed>
        <ion-row>
          <ion-col size="6">
            <ion-item>
              <ion-label position="stacked" color="tertiary"
                >Fecha Inicio</ion-label
              >
              <ion-input
                [(ngModel)]="sueldoFijo_fecha_inicio"
                type="date"
                (ionBlur)="actualizarFechaFinal()"
              ></ion-input>
            </ion-item>
          </ion-col>
          <ion-col size="6">
            <ion-item>
              <ion-label position="stacked" color="tertiary"
                >Fecha Final</ion-label
              >
              <ion-input
                [(ngModel)]="sueldoFijo_fecha_final"
                type="date"
                readonly
              ></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-list>

    <ion-button (click)="registrarSueldoFijo()" color="primary" expand="block">
      <ion-icon slot="end" name="save"></ion-icon>
      Registrar Sueldo Fijo
    </ion-button>
    <ion-button fill="clear" (click)="ocultarFormularioRegistro()">
      <ion-icon slot="icon-only" name="remove-circle-outline"></ion-icon>
    </ion-button>
  </ng-container>

  <ng-template #sueldoFijoExistente>
    <ion-card class="ion-margin-top" mode="ios">
      <ion-card-header>
        <ion-card-subtitle color="dark" class="sueldo"
          >{{ sueldoFijo }}</ion-card-subtitle
        >
        <ion-card-title color="tertiary">Su Sueldo Fijo es de</ion-card-title>
        <ion-buttons mode="ios">
          <ion-button (click)="mostrarFormularioRegistro()">
            <ion-icon name="add-circle-outline"></ion-icon>
          </ion-button>
          <ion-button (click)="ocultarFormularioRegistro()">
            <ion-icon name="remove-circle-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-card-header>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Seleccionar Categoría Predefinida</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label>Categoría</ion-label>
          <ion-select
            interface="popover"
            [(ngModel)]="categoria_id"
            placeholder="Seleccionar Categoría"
            (ionChange)="onCategoriaChange($event)"
          >
            <ion-select-option
              *ngFor="let categoria of listaCategoriasPredefinidas"
              [value]="categoria.id"
            >
              {{ categoria.nombre }}
            </ion-select-option>
            <ion-select-option [value]="0"
              >Agregar Nueva Categoría</ion-select-option
            >
          </ion-select>
        </ion-item>
        <ion-item *ngIf="categoria_id === 0">
          <ion-label position="floating">Nombre de la Categoría</ion-label>
          <ion-input [(ngModel)]="categoria_nombre" type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Descripción</ion-label>
          <ion-input
            [(ngModel)]="categoria_descripcion"
            type="text"
          ></ion-input>
        </ion-item>
        <ion-button
          (click)="registrarCategoria()"
          color="primary"
          expand="block"
        >
          <ion-icon slot="end" name="save"></ion-icon>
          Registrar Categoría
        </ion-button>
      </ion-card-content>
    </ion-card>
  </ng-template>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <app-tabs></app-tabs>
  </ion-toolbar>
</ion-footer>
